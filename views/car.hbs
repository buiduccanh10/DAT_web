<!DOCTYPE html>
<html>
<head>
    <title>Upload Car Excel File</title>
</head>
<body>
    <h1>Tải lên file Excel danh sách xe</h1>
    <form action="/uploadCar" method="post" enctype="multipart/form-data">
        <input type="file" name="file" required/>
        <button type="submit">Tải lên</button>
    </form>
    {{#if data}}
        <h2>Excel Data:</h2>
        <button id="saveButton" class="w3-btn w3-green w3-border w3-border-green w3-round">Lưu</button>

        <table border="1"  id="data-table">
        <tr>
            <th>Biển số xe</th>
            <th>Loại hạng xe</th>
        </tr>
        {{#each data}}
            <tr>
                <td>{{lookup this 'Biển số'}}</td>
                <td>{{lookup this 'Ghi chú'}}</td>
            </tr>
        {{/each}}
    </table>
    {{/if}}
</body>
</html>

<script>
        document.getElementById('saveButton').addEventListener('click', function () {
            const rows = document.querySelectorAll('#data-table tbody tr');
            const data = [];

            rows.forEach(row => {
                const rowData = {
                    BienSoXe: row.cells[0].textContent,
                    LoaiHangXe: row.cells[1].textContent,
                };
                data.push(rowData);
            });

            fetch('/save-car', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            }).then(response => {
                if (response.ok) {
                    alert('Data saved successfully!');
                } else {
                    alert('Error saving data.');
                }
            }).catch(error => {
                console.error('Error:', error);
                alert('Error saving data.');
            });
        });
    </script>
